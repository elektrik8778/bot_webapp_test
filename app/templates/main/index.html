<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link href="https://unpkg.com/nes.css@2.3.0/css/nes.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../../static/css/fonts.css"></link>
    <title>{{ title }}</title>
</head>
<body>
<main class="container-fluid" style="min-height: 100vh; background-color: black; font-family: '8BIT WONDER'">
    <section id="achieves" class="text-center">
        <i class="nes-icon is-large star is-transparent"></i>
        <i class="nes-icon is-large star is-transparent"></i>
        <i class="nes-icon is-large star is-transparent"></i>
        <i class="nes-icon is-large star is-transparent"></i>
        <i class="nes-icon is-large star is-transparent"></i>
{#        <i class="nes-icon trophy is-large"></i>#}
{#        <i class="nes-icon trophy is-large"></i>#}
{#        <i class="nes-icon trophy is-large"></i>#}
{#        <i class="nes-icon trophy is-large"></i>#}
{#        <i class="nes-icon trophy is-large"></i>#}
    </section>
    <section id="pers" class="text-center" style="height: 40vh; display: flex">
        <i class="nes-octocat animate" style="margin: auto"></i>
    </section>
    <section id="controls">
        <div class="row text-center">
            <div class="col-6">
                <a id="start-quest" class="nes-btn is-success" href="#">Пройти квест</a>
            </div>
            <div class="col-6">
                <a id="final-battle" class="nes-btn is-error" href="#">Финальная битва</a>
            </div>
        </div>
    </section>
</main>
<script>
    const bot = Telegram.WebApp;

    {#console.log(localStorage.uid)#}
    if (bot.initDataUnsafe.user)
        if (localStorage.uid === undefined || localStorage.uid !== bot.initDataUnsafe.user.id)
            localStorage.uid = bot.initDataUnsafe.user.id

    var uid = localStorage.uid;

    $('#start-quest').click(startQuest)
    $('#final-battle').click(finalBattle)

    function startQuest() {
        fetch(`/quest/${uid}`).then(result=>{
            console.log(result.text())
        })
        bot.close()
    }

    function finalBattle() {
        fetch(`/final_battle/${uid}`).then(result=>{
            console.log(result.text())
        })
        bot.close()
        bot.close()
    }

</script>
</body>
</html>
